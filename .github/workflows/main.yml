name: Setup ngrok and Remote Desktop

on:
  workflow_dispatch:  # ‚ùó Sirf manual run allowed

  jobs:
    setup-ngrok:
        runs-on: windows-latest
            timeout-minutes: 360
                steps:
                      - name: Checkout repository
                              uses: actions/checkout@v3

                                    - name: Download ngrok
                                            run: |
                                                      Invoke-WebRequetable-windows-amd64.zip -OutFile ngrok.zip
                                                          3-stable-windows-amd64.zip -OutFile ngrok.zip
                                                                    if (!(Test-Path -Path ngro  - name: Extow t ngrok
                                                                            run: |
                                                                                      Ex - name: Extrngrok.zip -DestinationPa { thro        if (!(Test-Path -k" }

                                                                                            -exe)) { throw "Fail
                                                                                                    run: .\ngr" }
                                                                                                    
                                                                                                          - name: Update ngrok
                                                                                                                  run: .\ngr" }
                                                                                                                  
                                                                                                                        - name: Update ngrok
                                                                                                                                run: .\ngrok.exe update
                                                                                                                                
                                                                                                                                      - name: Authenticate with ngrok
                                                                                                                                         KEN
                                                                                                                                            n: .\ngrok.exe au   NGROK_AUTH_TOKEN: TH_ secrets.NGROK_AUTH_TOKEN }}
                                                                                                                                            
                                                                                                                                                  - name: Enable Remoty -Psktop
                                                                                                                                                          run: |rrentControlSet\Control\Terminal Server' -name "irewallRule -DisplayGroup "Remote DesktoCurrentControlett\Control\Terminalh 'HKL-ValuStations\RDP-Tcp' -oame "UserAuthentication" -Value 1
                                                                                                                                                                    Set-Loame "UserAuthentication" -Value 1
                                                                                                                                                                        (Co   Set-LocalUser -Name "runneradmin" -Password (Co   Set-LocalUser -Name "rucalUser 3389
                                                                                                                                                                                    run: |
                                                                                                                                                                                              .\ngrok.exe tcp 3389
                                                                                                                                                                                               to create ngrok 
                                                                                                                                                                                                         while ($tame: {
                                                                                                                                                                                                                     Write-Outart "Keeping the workflo         }
                                                                                                                                                                                                                             continue-on-error: trueds 300
                                                                                                                                                                                                                                       }
                                                                                                                                                                                                                                               continue-on-error: trueds 300
                                                                                                                                                                                                                                                         }
                                                                                                                                                                                                                                                                 continue-on-error: trueds 300
                                                                                                                                                                                                                                                                           }
                                                                                                                                                                                                                                                                                   continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                             }
                                                                                                                                                                                                                                                                                                     continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                               }
                                                                                                                                                                                                                                                                                                                       continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                 }
                                                                                                                                                                                                                                                                                                                                         continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                   }
                                                                                                                                                                                                                                                                                                                                                           continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                                     }
                                                                                                                                                                                                                                                                                                                                                                             continue-on-error: trueds 300
                                                                                                                                                                                                                                                                                                                                                                                       }
                                                                                                                                                                                                                                                                                                                                                                                               continue-on-error: true
